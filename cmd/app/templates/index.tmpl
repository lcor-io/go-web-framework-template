{{ define "static" }}StaticRender{{ end -}}
{{ define "dynamic" }}DynamicRender{{ end -}}
//AUTOGENERATED
package {{ .Opts.Package}}

import (
	"github.com/a-h/templ"
	"github.com/gofiber/fiber/v3"

	"default.app/src/components"
	"default.app/src/utils/renderers"

	{{- range .SubRoutes}}
	"default.app/src/app/{{ .Path }}"
	{{- end }}
)

func RegisterRoutes(router fiber.Router) {
	router.Get("/", func(ctx fiber.Ctx) error {
		isBoosted, ok := ctx.Locals("isBoosted").(bool)

		// By leveraging the boot feature in HTMX, we can return only the content of the page and reduce the payload
		if ok && isBoosted {
			return renderers.{{ if (eq .Opts.Type "static") }}{{ template "static" }}{{ else }}{{ template "dynamic" }}{{ end }}(ctx, Index())
		}

		// But if JS is not enabled, we can still render the full page
		childContext := templ.WithChildren(ctx.Context(), Index())
		return renderers.{{ if (eq .Opts.Type "static") }}{{ template "static" }}{{ else }}{{ template "dynamic" }}{{ end }}(ctx, components.MainLayout(), renderers.WithContext(childContext))
	})

	//Routes
    {{- range .SubRoutes}}
	{{ .Opts.Package }}.RegisterRoutes(app.Group("/{{ .Path}}"))
	{{- end }}

	//Components
    {{- range $_, $route := .Routes }}
	router.Get("/{{ $route }}", func(ctx fiber.Ctx) error {
		return renderers.DynamicRender(ctx, Tab(1, "Content of tab 1"))
	})
	{{- end }}
}
